env:
  global:
  - secure: 0DPb1ibzou9SyBwHDdhbQMlf7kxyaLaaXFeWyvflmWk+6c7BkoOGLEdjC8uSHMX0HCXt0NkRHHUp4qTzTKwV/wX2aVh0DQdQXHQS2nfJeHJtyktsYO5QyfokrahRaX1A9gaCW0kyeElg4D3ah9L0R8HOM0eaO9e5+SZ09dCArGoHonDymQQpxcJ/IPwCiqByba8A1Q721+y4Y/kBZxXl15/UZB6M781goHIHdm/UGcezNM7Oe7gBgXWQu2C+HlR7hxp3rycNxrAX1iuyhesC1uVprprbnsnEVIcWGOo5POLbG79IPrkvVkhKS6sL4a3Xa5kzmlvDnQkFEvFWFpwWoLahdqeXCkfcZ/zN2gnJWauUXrXOqFiHHVr97LMBLG8fveuDECJzrMVPN10rD/cAbt8YXub8XvZ5fV4913JAHl+XB4YDy5KSPCqBG4z9ljRv9gaM022rPFyPKqmBclbK2u/oCXP7lBUWAsuXqsxD69P+Kx8bMrNDuVChWZw4QMOMAAPCq/pi796HCIMYOiAykEuxLqbMbnzFHxsTr+ICdNKQVZ0s7k3eCo8nM8BQnjXqTKu0tDmO0ImdPtjaCIw1AfqYCRTHSWdbbWKlDR9fPJoxYJHsd3h/rcbP0NWbcB1ovA+ESogcKSlHRagVwa51EaWovAQ4ePyY2suiDMkdi8g=
  - secure: qNG3Ni0IvxEJy4RzGWhVR7s2xrXg54qjyaXKaqdmLg4vTvF20LiWGG68sPosrxS98rk6lGL2wTIlsIaLe0MeD6JiF44OO4S8CJfEe2EEEXMXFTI9uV7amYe/kcr8eEdvpFrlUDG+ZnOVYlq6/eYSsew2dqtLj7EyDfSYRvebcbeW1d0aycgjvG2NQyGsjCQzTCCxHcQyHXquwCZWokN5KRWInbQneDPdwlCjq+/DqXtyC3fppXndWdDitUUfGBeHHpb2iIumt3RgHgYpm1FH7T4RrYdxWCrD+krqFNFy9LSg5nuCie4pY1zLeEZ3YrqAsLcBArEHi8k3R3LuJn6xbxh973Omx59A0KQYC/6y6n+1JH0kt41qYFhn0pDsJJbzygGFp6roMYza4IjT/ceY9/4GIGykJInt1Qej/P2C4RCL2S+/ijm53142bmlieEdfTuyjIRg9BGJbzTg8B1D3yMp52jh1YQfvjWNgy81VwKKbf0UmxvOV2Xfgh2jylOldDuwZx9Gg7SDX15ZT+MFDWIQO0LI4FGVMRWS95E2qVqsEN8O+l5n5s0nLXEMk84mPVlWpDZTBC2zoHWr3PepkvJoJmZCOVhoGgqinEpi+NCRfKpE+fLnuy/k9icTQiNLlJNBqJ4/CWhcXUVx4YI01jkYedP9XGw91COWzNVDsFFw=

services:
- docker

#addons:
#  sonarcloud:
#    organization: departement-loire-atlantique
#    token:
#      secure: M+8vAHlAT0EB4byV3wLQcWKiZF/JmolYEd7GDydRwAXBqWZsCNmWh80C0Nr2o4OhQpHrvSe3MROD4ZAH8gYAaWYZwaFm00NLLrjW1yb3rx0ExgeuSS5tzmjujSf61hbQaKw+3u2nDZMWaANfti4a5Cur9tFEcLXt2SAhNWV9jWxXb2cHrNdcT22qKigXrzJBWeAwvcKqCcKKGPoMfiMVcMqTb7caMRImIpleniRFQ/kjhOVrE10Qj/IyHgR34a8IBLBGvjJVNkCmYNMJ4IIOXjZl4QxJo68PvkXqToD7+bSZRp2GD1yaOFY4yr+Qu9L8ZlPgJ5D2VuPfYgUAGkBLt+p5SOP34a40H3OHTjxBaA4xCF3oswdO9w0zriNjgw+Fxn3XjGYWwpcrP69uZPDpgBAY9xTzFeZQA15HCqqKObe352FbXcYg4vuqKbGIcnUVobPXBicjGhgWzQMI/LWHb5aDRyOaUJL3UfPv0yKr55Re2VvqLg4zc52oNu6kuPT+dEWig9i5GEhQjTbLdMdZfGGk+++95PS9c39hp19cBYcjbcM6PdGYHWf/lKfi9qk7JZTXYoaso0eiS2Nm2gnYD9boPODSBlhWV+gQC0HyJjNKJ/79wYLqYRqXddHVqJiF5NdbuYZsH18Wilu1ssMshuMncTZ5c140GWHpsplKtYA=

before_script:
- echo "$DOCKER_PASS" | docker login --username $DOCKER_USER --password-stdin
- docker pull julienbayle/jplatformbuild

script:
- docker run -v ${TRAVIS_BUILD_DIR}:/root/source --name buildimage -t julienbayle/jplatformbuild
- docker cp buildimage:/root/dist .
#- export CODE_VERSION=`git describe`
#- sonar-scanner -Dsonar.projectVersion=$CODE_VERSION

deploy:
  provider: releases
  api_key:
    secure: LoFnFRsyMSwrbtr7ul6p9oLt02U7C6l3jolzIGMxjrCwMz+EM8/51zNupOvxefpIhngLCXKe97eCjxN0qdN9FLK87TEPTxVPSe3ULbb1xuRulOer8IO3a2EsvgwpWEavJ62SzUnbKMU9MwtxAzSw8BDetFn1KENmlYSrn6VQ3LAEjh/SAE9Haacnljakc5S/adHlwHfqWTnj1Crr7inFat8n377GBOinU3Kb5jB5kX13us6fg8NP08jO+MzeoT5w8oaKWeHgD4tmx474my5T8mRGV7RYFf2FHPyKniXpzdY1wQGD31eHxbqNy3RNGft5/3sRrzIE68S20TLPrWRrj6BuaNYSRwy1HyrKoc+wJOhgk3Ki0WKpK2CF+Tx9yvY9eDhgjtqjw44mD/+KbEe2U0zT4JmK4JyJ3SItCQk/boa8LUMwcqD32ELAwBL9sCaf27Lxax05bMTxdcsUwTt7KFlXvPJBDCkCVvAkohxykw+kC04uMO3fuACKBd7pA9mg4mzKHqhL4ctHCfuAshas6IVdvkwD2tM4trdYvC/aR12VOOv4tHkrNsrNyTUilB+ApGrdjfga7fyIDA3TcaCV7jvMMat5t5R49FfwxC0WSomRoo74YTOFMWat7rigltAh6bSxxdElmeshRBdEAtwUa0mwdshbU+m96G4mx60kEEU=
  file_glob: true
  file: "${TRAVIS_BUILD_DIR}/dist/*.zip"
  skip_cleanup: true
  on:
    tags: true
